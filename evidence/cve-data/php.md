# CVE Pattern Summary: PHP

## Executive Summary

This document provides a structured baseline of vulnerability patterns in PHP applications, synthesized from NVD, OWASP, and industry security research. It distinguishes between weaknesses in the PHP language itself, the PHP runtime ecosystem, and third-party PHP applications. The analysis is intended to support council agents in understanding the threat landscape and calibrating security priorities.

**Document Date:** February 2026
**Time Period Covered:** 2020–2025 (with historical references where relevant)
**Data Sources:** NVD CVE Database, OWASP Top 10, CWE/MITRE, CVEdetails, academic security research

---

## 1. Most Common CWE Categories Affecting PHP Applications

### Injection Vulnerabilities (CWE-89, CWE-79, CWE-78)

**CWE-89: SQL Injection**
- **Prevalence:** ~14,000+ CVEs reported across all languages; consistent presence in PHP-targeted applications
- **PHP-Specific Factors:**
  - Deprecated `mysql_*` functions (removed in PHP 7.0) lack prepared statement support by default
  - Manual string escaping with `mysql_real_escape_string()` remains error-prone and insufficient against certain attack vectors
  - Legacy codebases still using deprecated APIs; widespread migration to PDO/MySQLi ongoing but incomplete
  - Loose type juggling (`==` vs `===`) can lead to unexpected type conversions in comparison, creating bypass opportunities

**CWE-79: Cross-Site Scripting (XSS)**
- **Prevalence:** ~30,000+ CVEs; ranks #2 in CWE Top 25
- **PHP-Specific Factors:**
  - Permissive default output behavior; no automatic HTML escaping by default
  - Template engines vary in escape defaults (some auto-escape, others do not)
  - Common in legacy applications with minimal output validation

**CWE-78: OS Command Injection**
- **Prevalence:** Thousands of CVEs; recently critical PHP-CGI argument injection (CVE-2024-4577, CVSS 9.8)
- **Recent Example:** CVE-2024-4577 affected PHP 8.3 < 8.3.8, 8.2 < 8.2.20, 8.1 < 8.1.29; exposed ~458,800 instances as of June 2024
- **PHP-Specific Factors:**
  - Functions like `shell_exec()`, `system()`, `exec()`, `passthru()` remain commonly misused
  - CGI-mode deployments on Windows systems have unique attack surfaces

### CWE-98: PHP Remote File Inclusion / Local File Inclusion (RFI/LFI)

- **Prevalence:** Historical spike in 2006 (~1000% increase); persistent in legacy codebases
- **PHP-Specific Factors:**
  - `include()`, `require()`, `include_once()`, `require_once()` with user input
  - Stream wrappers (data://, file://, etc.) expand attack surface
  - Extremely common in legacy PHP frameworks and custom applications
  - Well-understood by attackers; frequently chained with other vulnerabilities

### CWE-434: Unrestricted File Upload

- **Prevalence:** Common in web applications; CWE Top 25 presence
- **PHP-Specific Factors:**
  - Ability to execute uploaded `.php` files directly if stored in web root
  - Double-extension bypasses (e.g., `image.jpg.php`)
  - MIME type spoofing; insufficient magic-byte validation
  - Server misconfiguration allowing PHP execution in upload directories

### CWE-287: Improper Authentication / CWE-284: Improper Access Control

- **Prevalence:** Ranks #1 in OWASP Top 10:2021 (Broken Access Control)
- **PHP-Specific Factors:**
  - Historical `register_globals` feature (enabled by default in PHP < 5.4)
  - Session management vulnerabilities; predictable session IDs
  - Custom authentication code more common than framework-based
  - Weak password hashing (MD5, SHA1 without salt) in legacy applications

### CWE-611: Improper Restriction of XML External Entity Reference (XXE)

- **Prevalence:** Moderate; affects XML/SOAP processing
- **PHP-Specific Factors:**
  - SimpleXML and DOM libraries enabled by default
  - XXE often overlooked in file import/parsing features

### CWE-90: LDAP Injection; CWE-917: Expression Injection

- **Prevalence:** Lower frequency, but high impact in directory services integrations
- **PHP-Specific Factors:**
  - Custom LDAP binding logic; limited framework guidance

---

## 2. Language-Level Factors Contributing to PHP Vulnerabilities

### Type System and Loose Comparison

PHP's dynamic, loosely-typed system creates several vulnerability patterns:

- **Loose Comparison (`==` vs `===`):** Type juggling allows `"0" == false`, `"123abc" == 123`, enabling authentication bypasses and SQL injection chains
- **Automatic Type Coercion:** User input from GET/POST naturally arrives as strings; implicit conversion to integers/floats can mask validation errors
- **Comparison in Authentication:** Example from security research: an ExpressionEngine vulnerability allowed type juggling to bypass authentication via deserialization and SQL injection

### Legacy API Design

Several deprecated APIs remain in active use across the ecosystem:

- **`mysql_*` Functions (Removed PHP 7.0):**
  - No prepared statement support; required manual string escaping
  - No modern connection pooling or SSL options
  - Security guidance emphasized `mysql_real_escape_string()`, which is insufficient
  - Replacement APIs (MySQLi, PDO) offer prepared statements but require code migration

- **`register_globals` (Removed PHP 5.4.0):**
  - Automatically populated global scope with GET/POST/COOKIE values
  - Enabled variable overwrite attacks in initialization-free code
  - Legacy mitigation: manual `isset()` checks instead of secure defaults

- **`eval()` and Variable Functions:**
  - `eval()`, `assert()` with user input remains a code injection vector
  - `$$variable` (variable variables) can expose unintended global state
  - `call_user_func()`, `call_user_func_array()` with user-controlled function names

### Output Encoding Defaults

- PHP does not auto-escape output; developers must explicitly use `htmlspecialchars()`, `htmlentities()`, or framework escape functions
- Template engines vary: some (Twig, Blade) default to escaping; others (plain PHP templates) do not
- XSS remains prevalent due to ergonomic friction in secure-by-default output

### Stream and Include Semantics

- `allow_url_fopen` and `allow_url_include` (php.ini directives) permit remote file access via `include()`
- Stream wrappers (`php://`, `data://`, `zip://`) expand attack surface beyond filesystem includes
- Null-byte injection (PHP < 5.3.4) historically bypassed extension checks in path traversal

### Object Serialization

- `unserialize()` without strict options permits object instantiation of arbitrary classes
- POP (Property-Oriented Programming) chains can trigger code execution
- `serialize()` / `unserialize()` of user input is a common code injection vector

---

## 3. Key Vulnerability Distribution Patterns

### Top CWE Categories by Estimated Frequency

Based on NVD and OWASP data (2020–2025):

1. **CWE-79 (XSS):** ~30,000 CVEs (longest-running web flaw; persistent across all frameworks)
2. **CWE-89 (SQL Injection):** ~14,000 CVEs (common in custom queries and legacy APIs)
3. **CWE-78 (OS Command Injection):** ~1,000+ active CVEs (PHP-specific: CGI arg injection, shell_exec misuse)
4. **CWE-98 (RFI/LFI):** Hundreds of active CVEs (especially in legacy applications)
5. **CWE-434 (Unrestricted File Upload):** Thousands of CVEs (language-agnostic, but PHP's direct execution model amplifies risk)
6. **CWE-287/284 (Auth/Access Control):** Tens of thousands across all languages; PHP-specific: custom session handling, register_globals residue
7. **CWE-611 (XXE):** Hundreds to low thousands

### Injection Flaws Across Categories

- OWASP data: 94% of tested applications encountered some form of injection; average incidence 3%, max 19%
- Injection (including SQL, LDAP, OS command) ranks #5 in OWASP Top 10:2025

---

## 4. Ecosystem vs. Language Vulnerabilities

### PHP-the-Language Vulnerabilities

Weaknesses in the PHP runtime itself (e.g., CVE-2024-4577 CGI argument injection):
- ~100–200 CVEs per year in PHP core and standard library
- Typically high severity due to installed base (~77% of websites with known server-side language)
- Patches released regularly by PHP Security Team

### PHP-the-Ecosystem Vulnerabilities

Security weaknesses in popular frameworks, libraries, and applications:
- WordPress, Drupal, Magento, Laravel, Symfony, etc.
- Vastly outnumber core language CVEs
- Often rooted in language-level weaknesses (e.g., type juggling, unescaped output)

### Deployed Footprint Impact

- **Scale:** PHP powers ~77% of websites with identifiable server-side languages (as of 2025)
- **Heterogeneity:** Massive version spread (PHP 5.4 through 8.3 in active use); framework adoption varies
- **Consequence:** A single critical PHP vulnerability can affect hundreds of thousands to millions of sites
  - Example: CVE-2024-4577 exposed ~458,800 instances within months of public disclosure
- **Detection Bias:** High visibility in CVE databases due to scale, not necessarily higher-per-capita weakness rate

---

## 5. Data Sources and Methodology

### Primary Sources

- **NVD (National Vulnerability Database):** nist.gov/vuln; CWE mappings, CVSS scoring, CPE affected products
- **CWE/MITRE:** Common Weakness Enumeration definitions, prevalence trends, CWE-1003 enriched subset for NVD
- **OWASP Top 10 (2021, 2025 editions):** https://owasp.org/www-project-top-ten/; incidence rates from testing data
- **CVEdetails:** https://www.cvedetails.com; granular CVE counts by CWE, vendor, product
- **CISA Known Exploited Vulnerabilities Catalog:** https://www.cisa.gov/known-exploited-vulnerabilities-catalog

### Supplementary Sources

- Security advisories from PHP Security Team (https://www.php.net/security)
- Academic research on type juggling and language-specific vulnerabilities
- Industry reports (Censys, Traceable, BitSight) on exposure tracking
- OWASP community resources on PHP-specific weaknesses

### Frequency Data Caveats

- **CVE Counts Are Not Raw Incidence Rates:** A single PHP application may contain multiple CWE-89 (SQL injection) issues, each reported as separate CVEs; the count reflects *vulnerability reports*, not *distinct vulnerable applications*
- **Reporting Bias:** Well-known frameworks and high-impact projects attract security research; smaller applications are underrepresented
- **Time Lag:** NVD analysts have not evaluated all publicly disclosed CVEs; as of early 2025, ~18,500 of 40,000+ 2024 CVEs were analyzed
- **Language Attribution:** CVEs may be attributed to the affected product (e.g., "WordPress") rather than underlying PHP weaknesses

---

## 6. Time Period and Scope

**Document Coverage:** 2020–2025

- Reflects modern PHP versions (7.4, 8.0, 8.1, 8.2, 8.3) and contemporary frameworks
- Includes historical context for deprecated features (register_globals removed 2009, mysql_* removed 2020)
- Recent data from June 2024 (CVE-2024-4577) and February 2026 (current)

**Out of Scope:**

- Vulnerabilities specific to PHP extensions (e.g., ImageMagick, GD issues)
- Server configuration weaknesses not attributable to the language (e.g., improper file permissions)
- Third-party library vulnerabilities (except where they exemplify language-level patterns)

---

## 7. Key Caveats and Limitations

### Distinguishing PHP-the-Language from the Ecosystem

This document aims to flag language-level design factors (loose typing, legacy APIs, default-permissive output) that enable vulnerabilities. However:

- **Ecosystem dominates by volume:** The vast majority of PHP CVEs are in applications, not the language itself
- **Mitigating factors:** Modern frameworks (Laravel, Symfony) and libraries (Twig) have secure-by-default designs that compensate for language weaknesses
- **Skill and practice matter:** Experienced PHP developers familiar with prepared statements, escaping, and input validation produce secure code, regardless of language quirks

### Controlling for PHP's Deployed Footprint

- PHP's 77% market share inflates absolute CVE counts but may not reflect higher-per-capita vulnerability rates
- Comparisons with Python, Node.js, Ruby, etc. are difficult without normalizing for:
  - Age of the language (PHP's legacy codebase is older)
  - Diversity of use cases (PHP historically skewed toward web applications; modern PHP spans APIs, CLIs, etc.)
  - Security tooling maturity (modern scanners focus on OWASP Top 10 across all languages)

### Data Quality Notes

- **CWE Mapping Lag:** Not all CVEs have CWE assignments; newer vulnerabilities may be unmapped
- **Multiple CWE Labels:** A single vulnerability may be tagged with multiple CWEs (e.g., SQL injection + authentication bypass)
- **Severity Score Drift:** CVSS v3.1 has largely replaced v3.0 and earlier; historical comparisons require normalization

---

## 8. Recommendations for Security Analysis

When using this baseline for threat modeling or vulnerability assessment:

1. **Treat CVE counts as relative indicators, not absolute rates.** A higher CWE count suggests attack surface, but requires context (deployed footprint, exploit maturity, attack cost)
2. **Separate language weakness from implementation failure.** Type juggling and unescaped output are language-level; failing to use prepared statements is implementation-level
3. **Account for framework choice.** Applications using Laravel or Symfony with secure defaults have dramatically different risk profiles than custom PHP from the early 2000s
4. **Monitor version adoption.** PHP 5.x (unsupported since 2018) still represents a non-trivial fraction of the installed base; recommend transition plans for legacy deployments
5. **Integrate with runtime protections.** Prepared statements, output escaping, and input validation are essential; static analysis and WAF policies provide additional defense layers

---

## References

- MITRE CWE. "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')". https://cwe.mitre.org/data/definitions/79.html
- MITRE CWE. "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')". https://cwe.mitre.org/data/definitions/89.html
- MITRE CWE. "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')". https://cwe.mitre.org/data/definitions/78.html
- MITRE CWE. "CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program". https://cwe.mitre.org/data/definitions/98.html
- MITRE CWE. "CWE-434: Unrestricted Upload of File with Dangerous Type". https://cwe.mitre.org/data/definitions/434.html
- MITRE CWE. "Weakness Type Distributions in CVE". https://cwe.mitre.org/documents/vuln-trends/index.html
- NIST NVD. "Search and Statistics". https://nvd.nist.gov/vuln/search
- NIST NVD. "CWE Over Time Visualization". https://nvd.nist.gov/general/visualizations/vulnerability-visualizations/cwe-over-time
- OWASP Foundation. "OWASP Top 10 Web Application Security Risks (2025)". https://owasp.org/www-project-top-ten/
- OWASP Foundation. "Injection". https://owasp.org/Top10/2025/A05_2025-Injection/
- OWASP Foundation. "PHP Object Injection". https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection
- Invicti. "PHP Type Juggling Vulnerabilities & How to Fix Them". https://www.invicti.com/blog/web-security/php-type-juggling-vulnerabilities
- Foxglove Security. "Type Juggling and PHP Object Injection, and SQLi, Oh My!". https://foxglovesecurity.com/2017/02/07/type-juggling-and-php-object-injection-and-sqli-oh-my/
- Censys. "June 10, 2024: PHP-CGI Argument Injection Vulnerability Could Lead to Remote Code Execution". https://censys.com/cve-2024-4577/
- Traceable. "Critical PHP CGI Argument Injection Vulnerability (CVE-2024-4577)". https://www.traceable.ai/blog-post/critical-php-cgi-argument-injection-vulnerability-cve-2024-4577-leads-to-remote-code-execution
- CVEdetails. "PHP: Security Vulnerabilities, CVEs". https://www.cvedetails.com/product/128/PHP-PHP.html
- PHP Foundation. "PHP Security". https://www.php.net/security
- BeagleSecurity. "PHP register-globals is enabled". https://beaglesecurity.com/blog/vulnerability/php-register-globals-enabled.html
- Acunetix. "PHP register_globals Enabled - Vulnerabilities". https://www.acunetix.com/vulnerabilities/web/php-register_globals-enabled/
- SQLPey. "Why Are MySQL Functions Deprecated in PHP & How to Migrate to PDO for Secure Database Interactions". https://sqlpey.com/php/php-mysql-deprecated-pdo-migration/
- ImmuniWeb. "PHP File Inclusion Vulnerability | CWE-98 Weakness". https://www.immuniweb.com/vulnerability/php-file-inclusion.html
- Wikipedia. "File Inclusion Vulnerability". https://en.wikipedia.org/wiki/File_inclusion_vulnerability
